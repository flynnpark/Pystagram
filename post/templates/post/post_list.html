{% extends "post/layout.html" %}
{% load humanize %}
{% load post_extras %} {# custom filter 추가 #}

{% if tag %}
    {% block title %}
        #{{ tag }} - Pystagram
    {% endblock %}
{% endif %}

{% block content %}
    {% if tag %}
        {% if not post_list %}
            <p>"#{{ tag }}" 태그 검색 결과가 없습니다.</p>
        {% else %}
            <p>"#{{ tag }}" 태그 검색 결과</p>
            <p>게시물 {{ post_list.count|intcomma }}개</p>
        {% endif %}
    {% endif %}
    {% for post in post_list %}
        <ul>
            <li>{{ post.author.profile.nickname }}</li>
            {% if post.author == user %}
            <li><a href="{% url "post:post_edit" post.pk %}">수정</a> / <a href="{% url "post:post_delete" post.pk %}" onClick="return confirm('정말 삭제하시겠습니까?')">삭제</a></li>
            {% endif %}
            <li><img src="{{ post.photo.url }}" alt="{{ post.author }}의 사진"></li>
            {{ post|add_link|safe|linebreaksbr }}
            <li>{{ post.created_at|naturaltime }}</li>
        </ul>
    {% endfor %}
{% endblock %}
